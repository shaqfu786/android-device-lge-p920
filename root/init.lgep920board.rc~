import init.lgep920board.usb.rc

on early-init
    # Increase readahead buffers on MMC devices
    write /sys/block/mmcblk0/bdi/read_ahead_kb 512
    write /sys/block/mmcblk1/bdi/read_ahead_kb 512

on init
 
    loglevel 3

# See storage config details at http://source.android.com/tech/storage/
    # Create mount points for Sdcard0(Internal_sd)
    mkdir /mnt/media_rw/sdcard0 0700 media_rw media_rw
    mkdir /storage/sdcard0 0700 root root

    export EXTERNAL_STORAGE /storage/sdcard0

    # for backwards compatibility
    symlink /storage/sdcard0 /sdcard
    symlink /storage/sdcard0 /mnt/sdcard

    # Create mount points for Sdcard1(External_sd)
    mkdir /mnt/media_rw/sdcard1 0700 media_rw media_rw
    mkdir /storage/sdcard1 0700 root root

    export SECONDARY_STORAGE /storage/sdcard1

    # for backwards compatibility
    symlink /storage/sdcard1 /ext_sdcard
    symlink /storage/sdcard1 /mnt/ext_sdcard

    mkdir /storage/sdcard0/.android_secure 0775 system system
    symlink /storage/sdcard0/.android_secure /sdcard/.android_secure
    symlink /storage/sdcard0/.android_secure /mnt/sdcard/.android_secure

    chown system system /sys/module/lge_handle_panic/parameters/hidden_reset_enable
    chmod 660 /sys/module/lge_handle_panic/parameters/hidden_reset_enable

    mkdir /misc 0771 system misc
    mkdir /data/lgdrm 0770 lgdrm lgdrm_acc

    mkdir /sqlite_stmt_journals 01777 root root
    mount tmpfs tmpfs /sqlite_stmt_journals size=4m

    # change permissions for alsa nodes
    symlink /dev/snd/pcmC0D0c /dev/pcmC0D0c
    symlink /dev/snd/pcmC0D0p /dev/pcmC0D0p
    symlink /dev/snd/controlC0 /dev/controlC0
    symlink /dev/snd/timer /dev/timer
    chmod 0777 /dev/pcmC0D0c
    chmod 0777 /dev/pcmC0D0p
    chmod 0777 /dev/controlC0
    chmod 0777 /dev/timer 

# LGE STUFFS
    chown root radio /proc/cmdline
    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0020/gripsuppression
    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0020/handsuppression
    chown system radio /sys/devices/platform/omap/omap_i2c.2/i2c-2/2-0036/brightness
    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0036/enable
    chown system radio /sys/devices/platform/keypad_led/leds/keyboard-backlight/brightness
    chown system radio /sys/devices/platform/omap-keypad/key_test_mode
    chown system radio /sys/devices/platform/i2c_omap.4/i2c-4/4-0068/cal_onoff
    chown system radio /misc/cal.bin

    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/atime
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/ptime
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/wtime
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/ppcount
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/pers
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/pilt
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/piht
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/GA
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/DF
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/pdata
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/interrupt_als
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/interrupt_prox
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/proxidata
    chown system system /sys/devices/platform/omap/omap_i2c.3/i2c-3/3-0039/luxdata

    chown system system /sys/devices/platform/omapdss/display0/enabled
    chown system system /sys/devices/platform/omapdss/display1/enabled
    chown system system /sys/devices/platform/omapdss/display2/enabled
    chown system system /sys/devices/platform/omapdss/display3/enabled
    chown system system /sys/devices/platform/omapdss/display0/name
    chown system system /sys/devices/platform/omapdss/display1/name
    chown system system /sys/devices/platform/omapdss/display2/name
    chown system system /sys/devices/platform/omapdss/display3/name
    chown system system /sys/devices/platform/omapdss/overlay0/manager
    chown system system /sys/devices/platform/omapdss/overlay1/manager
    chown system system /sys/devices/platform/omapdss/overlay2/manager
    chown system system /sys/devices/platform/omapdss/overlay3/manager
    chown system system /sys/devices/platform/omapdss/overlay0/zorder
    chown system system /sys/devices/platform/omapdss/overlay1/zorder
    chown system system /sys/devices/platform/omapdss/overlay2/zorder
    chown system system /sys/devices/platform/omapdss/overlay3/zorder
    chown system system /sys/devices/platform/omapdss/overlay0/position
    chown system system /sys/devices/platform/omapdss/overlay1/position
    chown system system /sys/devices/platform/omapdss/overlay2/position
    chown system system /sys/devices/platform/omapdss/overlay3/position
    chown system system /sys/devices/platform/omapdss/overlay0/output_size
    chown system system /sys/devices/platform/omapdss/overlay1/output_size
    chown system system /sys/devices/platform/omapdss/overlay2/output_size
    chown system system /sys/devices/platform/omapdss/overlay3/output_size
    chown system system /sys/devices/platform/omapdss/overlay0/portrait_position
    chown system system /sys/devices/platform/omapdss/overlay1/portrait_position
    chown system system /sys/devices/platform/omapdss/overlay2/portrait_position
    chown system system /sys/devices/platform/omapdss/overlay3/portrait_position
    chown system system /sys/devices/platform/omapdss/overlay0/portrait_output_size
    chown system system /sys/devices/platform/omapdss/overlay1/portrait_output_size
    chown system system /sys/devices/platform/omapdss/overlay2/portrait_output_size
    chown system system /sys/devices/platform/omapdss/overlay3/portrait_output_size
    chown system system /sys/devices/platform/omapdss/overlay0/input_size
    chown system system /sys/devices/platform/omapdss/overlay1/input_size
    chown system system /sys/devices/platform/omapdss/overlay2/input_size
    chown system system /sys/devices/platform/omapdss/overlay3/input_size
    chown system system /sys/devices/platform/omapdss/overlay0/color_mode
    chown system system /sys/devices/platform/omapdss/overlay1/color_mode
    chown system system /sys/devices/platform/omapdss/overlay2/color_mode
    chown system system /sys/devices/platform/omapdss/overlay3/color_mode
    chown system system /sys/devices/platform/omapdss/manager0/name
    chown system system /sys/devices/platform/omapdss/manager0/display
    chown system system /sys/devices/platform/omapdss/manager0/trans_key_value
    chown system system /sys/devices/platform/omapdss/manager0/trans_key_type
    chown system system /sys/devices/platform/omapdss/manager0/trans_key_enabled
    chown system system /sys/devices/platform/omapdss/manager1/name
    chown system system /sys/devices/platform/omapdss/manager1/display
    chown system system /sys/devices/platform/omapdss/manager1/trans_key_value
    chown system system /sys/devices/platform/omapdss/manager1/trans_key_type
    chown system system /sys/devices/platform/omapdss/manager1/trans_key_enabled
    chown system system /sys/devices/platform/omapdss/manager2/name
    chown system system /sys/devices/platform/omapdss/manager2/display
    chown system system /sys/devices/platform/omapdss/manager2/trans_key_value
    chown system system /sys/devices/platform/omapdss/manager2/trans_key_type
    chown system system /sys/devices/platform/omapdss/manager2/trans_key_enabled
    chown system system /sys/devices/platform/omapdss/overlay0/enabled
    chown system system /sys/devices/platform/omapdss/overlay1/enabled
    chown system system /sys/devices/platform/omapdss/overlay2/enabled
    chown system system /sys/devices/platform/omapdss/overlay3/enabled

    chown system system /sys/devices/platform/omapdss/display0/timings
    chown system system /sys/devices/platform/omapdss/display1/timings
    chown system system /sys/devices/platform/omapdss/display2/timings
    chown system system /sys/devices/platform/omapdss/display3/timings

    chown system system /sys/devices/platform/omapfb/graphics/fb0/overlays
    chown system system /sys/devices/platform/omapfb/graphics/fb0/overlays_rotate
    chown system system /sys/devices/platform/omapfb/graphics/fb1/overlays
    chown system system /sys/devices/platform/omapfb/graphics/fb1/overlays_rotate

    chown system system /sys/devices/platform/omapdss/display1/hdmi_out
    chown system system /sys/devices/platform/omapdss/display1/hdmi_source
    chown system system /sys/devices/platform/omapdss/display1/hdmi_key
    chown system system /sys/devices/platform/omapdss/display1/hdmi_drm_lock
    chown system system /sys/devices/platform/omapdss/display1/hdmi_drm_usr_sel
    chown system system /sys/devices/platform/omapdss/display1/custom_edid_timing
    chown system system /sys/devices/platform/omapdss/display1/hpd_enabled

    chown system system /sys/devices/platform/omapdss/display0/sgx_manual_recovery
    chmod 0775 /sys/devices/platform/omapdss/display0/sgx_manual_recovery

    # change permissions for overlay managers and display devices
    chmod 0775 /sys/devices/platform/omapdss/display0/enabled
    chmod 0775 /sys/devices/platform/omapdss/display1/enabled
    chmod 0775 /sys/devices/platform/omapdss/display2/enabled
    chmod 0775 /sys/devices/platform/omapdss/display3/enabled
    chmod 0775 /sys/devices/platform/omapdss/display0/name
    chmod 0775 /sys/devices/platform/omapdss/display1/name
    chmod 0775 /sys/devices/platform/omapdss/display2/name
    chmod 0775 /sys/devices/platform/omapdss/display3/name
    chmod 0775 /sys/devices/platform/omapdss/overlay0/manager
    chmod 0775 /sys/devices/platform/omapdss/overlay1/manager
    chmod 0775 /sys/devices/platform/omapdss/overlay2/manager
    chmod 0775 /sys/devices/platform/omapdss/overlay3/manager
    chmod 0775 /sys/devices/platform/omapdss/overlay0/zorder
    chmod 0775 /sys/devices/platform/omapdss/overlay1/zorder
    chmod 0775 /sys/devices/platform/omapdss/overlay2/zorder
    chmod 0775 /sys/devices/platform/omapdss/overlay3/zorder
    chmod 0775 /sys/devices/platform/omapdss/overlay0/position
    chmod 0775 /sys/devices/platform/omapdss/overlay1/position
    chmod 0775 /sys/devices/platform/omapdss/overlay2/position
    chmod 0775 /sys/devices/platform/omapdss/overlay3/position
    chmod 0775 /sys/devices/platform/omapdss/overlay0/output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay1/output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay2/output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay3/output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay0/portrait_position
    chmod 0775 /sys/devices/platform/omapdss/overlay1/portrait_position
    chmod 0775 /sys/devices/platform/omapdss/overlay2/portrait_position
    chmod 0775 /sys/devices/platform/omapdss/overlay3/portrait_position
    chmod 0775 /sys/devices/platform/omapdss/overlay0/portrait_output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay1/portrait_output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay2/portrait_output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay3/portrait_output_size
    chmod 0775 /sys/devices/platform/omapdss/overlay0/input_size
    chmod 0775 /sys/devices/platform/omapdss/overlay1/input_size
    chmod 0775 /sys/devices/platform/omapdss/overlay2/input_size
    chmod 0775 /sys/devices/platform/omapdss/overlay3/input_size
    chmod 0775 /sys/devices/platform/omapdss/overlay0/color_mode
    chmod 0775 /sys/devices/platform/omapdss/overlay1/color_mode
    chmod 0775 /sys/devices/platform/omapdss/overlay2/color_mode
    chmod 0775 /sys/devices/platform/omapdss/overlay3/color_mode

    # change permissions for manager tranparency parameters
    chmod 0775 /sys/devices/platform/omapdss/manager0/name
    chmod 0775 /sys/devices/platform/omapdss/manager0/display
    chmod 0775 /sys/devices/platform/omapdss/manager0/trans_key_value
    chmod 0775 /sys/devices/platform/omapdss/manager0/trans_key_type
    chmod 0775 /sys/devices/platform/omapdss/manager0/trans_key_enabled
    chmod 0775 /sys/devices/platform/omapdss/manager1/name
    chmod 0775 /sys/devices/platform/omapdss/manager1/display
    chmod 0775 /sys/devices/platform/omapdss/manager1/trans_key_value
    chmod 0775 /sys/devices/platform/omapdss/manager1/trans_key_type
    chmod 0775 /sys/devices/platform/omapdss/manager1/trans_key_enabled
    chmod 0775 /sys/devices/platform/omapdss/manager2/name
    chmod 0775 /sys/devices/platform/omapdss/manager2/display
    chmod 0775 /sys/devices/platform/omapdss/manager2/trans_key_value
    chmod 0775 /sys/devices/platform/omapdss/manager2/trans_key_type
    chmod 0775 /sys/devices/platform/omapdss/manager2/trans_key_enabled
    chmod 0775 /sys/devices/platform/omapdss/overlay0/enabled
    chmod 0775 /sys/devices/platform/omapdss/overlay1/enabled
    chmod 0775 /sys/devices/platform/omapdss/overlay2/enabled
    chmod 0775 /sys/devices/platform/omapdss/overlay3/enabled

    # change permissions for display timings to get the resolutions
    chmod 0775 /sys/devices/platform/omapdss/display0/timings
    chmod 0775 /sys/devices/platform/omapdss/display1/timings
    chmod 0775 /sys/devices/platform/omapdss/display2/timings
    chmod 0775 /sys/devices/platform/omapdss/display3/timings

    # change framebuffer permission
    chmod 0775 /sys/devices/platform/omapfb/graphics/fb0/overlays
    chmod 0775 /sys/devices/platform/omapfb/graphics/fb0/overlays_rotate
    chmod 0775 /sys/devices/platform/omapfb/graphics/fb1/overlays
    chmod 0775 /sys/devices/platform/omapfb/graphics/fb1/overlays_rotate

    # change permissions for LCD backlightness
    chmod 0664 /sys/devices/platform/i2c_omap.2/i2c-2/2-0036/brightness
    # AT command AT%LEDON
    chmod 0664 /sys/devices/platform/keypad_led/leds/keyboard-backlight/brightness
    # AT command AT%GKPD
    chmod 0664 /sys/devices/platform/omap-keypad/key_test_mode

    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0053/flash
    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0053/flash_brightness
    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0053/torch
    chown system system /sys/devices/platform/i2c_omap.2/i2c-2/2-0053/enable

    # LGE_KERNEL_MUX START  jongho3.lee@lge.com
    chown root  radio /sys/class/power_supply/battery/gauge_control
    chown root  radio /sys/class/power_supply/battery/voltage_now

    # Disable fb1 wonki.choi@lge.com
    write /sys/devices/platform/omapfb/graphics/fb1/overlays ""
    write /sys/devices/platform/omapdss/overlay1/enabled 0
    # write /sys/devices/platform/omapdss/overlay1/manager "2lcd"
    # Seting for HDMI plug-in wonki.choi@lge.com
    write /sys/devices/platform/omapdss/display1/enabled 0
    write /sys/devices/platform/omapdss/display1/hpd_enabled 1
    # setting HDMI Routing in system
    write /sys/devices/platform/omapdss/overlay3/manager "tv"
    write /sys/devices/platform/omapdss/overlay3/zorder 2

    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_out
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_source
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_key
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_rotation
    chmod 0775 /sys/devices/platform/omapdss/overlay1/input_size
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_3d_enable
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_3d_type
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_drm_lock
    chmod 0775 /sys/devices/platform/omapdss/display1/hdmi_drm_usr_sel
    chmod 0775 /sys/devices/platform/omapdss/display1/custom_edid_timing
    chmod 0775 /sys/devices/platform/omapdss/display1/hpd_enabled

   # HDMI device
   chown system system /sys/devices/platform/omapdss/overlay0/req_enabled
   chown system system /sys/devices/platform/omapdss/overlay0/req_rotation
   chown system system /sys/devices/platform/omapdss/overlay0/req_position
   chown system system /sys/devices/platform/omapdss/overlay0/req_out_size
   chown system system /sys/devices/platform/omapdss/overlay0/req_manager
   chown system system /sys/devices/platform/omapdss/overlay0/req_request
   chown system system /sys/devices/platform/omapdss/overlay0/req_global_alpha
   chown system system /sys/devices/platform/omapdss/overlay0/req_zorder

   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_enabled
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_rotation
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_position
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_out_size
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_manager
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_request
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_global_alpha
   chmod 0775 /sys/devices/platform/omapdss/overlay0/req_zorder

   chown system system /sys/devices/platform/omapdss/overlay1/req_enabled
   chown system system /sys/devices/platform/omapdss/overlay1/req_rotation
   chown system system /sys/devices/platform/omapdss/overlay1/req_position
   chown system system /sys/devices/platform/omapdss/overlay1/req_out_size
   chown system system /sys/devices/platform/omapdss/overlay1/req_manager
   chown system system /sys/devices/platform/omapdss/overlay1/req_request
   chown system system /sys/devices/platform/omapdss/overlay1/req_global_alpha
   chown system system /sys/devices/platform/omapdss/overlay1/req_zorder

   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_enabled
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_rotation
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_position
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_out_size
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_manager
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_request
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_global_alpha
   chmod 0775 /sys/devices/platform/omapdss/overlay1/req_zorder

   chown system system /sys/devices/platform/omapdss/overlay2/req_enabled
   chown system system /sys/devices/platform/omapdss/overlay2/req_rotation
   chown system system /sys/devices/platform/omapdss/overlay2/req_position
   chown system system /sys/devices/platform/omapdss/overlay2/req_out_size
   chown system system /sys/devices/platform/omapdss/overlay2/req_manager
   chown system system /sys/devices/platform/omapdss/overlay2/req_request
   chown system system /sys/devices/platform/omapdss/overlay2/req_global_alpha
   chown system system /sys/devices/platform/omapdss/overlay2/req_zorder

   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_enabled
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_rotation
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_position
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_out_size
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_manager
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_request
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_global_alpha
   chmod 0775 /sys/devices/platform/omapdss/overlay2/req_zorder

   chown system system /sys/devices/platform/omapdss/overlay3/req_enabled
   chown system system /sys/devices/platform/omapdss/overlay3/req_rotation
   chown system system /sys/devices/platform/omapdss/overlay3/req_position
   chown system system /sys/devices/platform/omapdss/overlay3/req_out_size
   chown system system /sys/devices/platform/omapdss/overlay3/req_manager
   chown system system /sys/devices/platform/omapdss/overlay3/req_request
   chown system system /sys/devices/platform/omapdss/overlay3/req_global_alpha
   chown system system /sys/devices/platform/omapdss/overlay3/req_zorder

   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_enabled
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_rotation
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_position
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_out_size
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_manager
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_request
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_global_alpha
   chmod 0775 /sys/devices/platform/omapdss/overlay3/req_zorder

    # Enable hotplug detection for HDMI
    write /sys/devices/platform/omapdss/display1/hpd_enabled 1

    # LGE_CHANGE_S 20120228, soye.park@lge.com [data] Increase TCP Buffer Size
    setprop net.tcp.buffersize.default 4096,87380,393216,4096,16384,110208
    setprop net.tcp.buffersize.wifi 524288,1048576,2097152,262144,524288,1048576
    setprop net.tcp.buffersize.lte 524288,1048576,2097152,262144,524288,1048576
    setprop net.tcp.buffersize.umts 4094,87380,393216,4096,16384,110208
    setprop net.tcp.buffersize.hspa 4094,87380,393216,4096,16384,110208
    setprop net.tcp.buffersize.edge 4093,26280,35040,4096,16384,35040
    setprop net.tcp.buffersize.gprs 4092,8760,11680,4096,8760,11680
    # LGE_CHANGE_E 20120228, soye.park@lge.com [data] Increase TCP Buffer Size 

    # LGE_CHANGE_S 20120720, hwansuk.kang@lge.com [data] Disable IPv6 for mobile network
    write /proc/sys/net/ipv6/conf/rmnet0/disable_ipv6 1
    write /proc/sys/net/ipv6/conf/rment1/disable_ipv6 1
    write /proc/sys/net/ipv6/conf/rmnet2/disable_ipv6 1
    # LGE_CHANGE_E 20120720, hwansuk.kang@lge.com [data] Disable IPv6 for mobile network

# END OF LGE STUFFS

    # flashlight
    chown system camera /sys/devices/platform/i2c_omap.2/i2c-2/2-0053/torch
    chmod 0660 /sys/devices/platform/i2c_omap.2/i2c-2/2-0053/torch

    # Allow everybody to read the xt_qtaguid resource tracking misc dev.
    # This is needed by any process that uses socket tagging.
    chmod 0644 /dev/xt_qtaguid

    wait /dev/block/mmcblk0p2

on fs
    mount_all /fstab.lgep920board
    swapon_all /fstab.lgep920board


    # Boost the CPU for 60 sec for boot optimization
    write /sys/devices/system/cpu/cpufreq/hotplug/boost_timeout 60000000
    write /sys/devices/system/cpu/cpu0/cpufreq/boost_cpufreq 1
    write /sys/devices/system/cpu/cpufreq/hotplug/boost_timeout 3000000

    # pvr module
    insmod /system/lib/modules/pvrsrvkm_sgx540_120.ko
    start pvrsrvinit

    # change permissions for i2c-2 device
    chmod 0660 /dev/i2c-2
    chown media media /dev/i2c-2

    # We chown/chmod /factory because mount is run as root + defaults
    chown radio radio /factory
    chmod 0775 /factory

    # The sensor blobs use this for calibration
    mkdir /log
    symlink /data/misc /log/misc

# KSM
     write /sys/kernel/mm/ksm/pages_to_scan 100
     write /sys/kernel/mm/ksm/sleep_millisecs 500
     write /sys/kernel/mm/ksm/run 1

# S3D
    # change permissions for S3D hardware
    chown system system /sys/devices/platform/omapdss/display0/s3d_enable
    chown system system /sys/devices/platform/omapdss/display0/s3d_type
    chown system system /sys/devices/platform/omapdss/display1/s3d_enable
    chown system system /sys/devices/platform/omapdss/display1/s3d_type

    # change permissions for Tiler driver
    chown media media /dev/tiler
    chmod 0666 /dev/tiler

# Bluetooth
    # all build into the kernel
    insmod /system/lib/modules/compat.ko
    # insmod /system/lib/modules/bluetooth.ko # force_acl_master=1 enable_mgmt=1 enable_le=1
    # insmod /system/lib/modules/rfcomm.ko 
    insmod /system/lib/modules/btwilink.ko      
    # insmod /system/lib/modules/bnep.ko
    insmod /system/lib/modules/tty_hci.ko

    chmod 0660 /dev/ttyO1
    chown bluetooth bluetooth /dev/ttyO1

# Wifi
    insmod /system/lib/modules/compat.ko
    insmod /system/lib/modules/cfg80211.ko
    insmod /system/lib/modules/mac80211.ko
    # insmod /system/lib/modules/wlcore.ko
    # insmod /system/lib/modules/wl18xx.ko
    insmod /system/lib/modules/wl12xx.ko #debug_level=0x63c00

on post-fs
    mount rootfs rootfs / ro remount
    symlink /dev/ttyGS0 /dev/acm0

# create basic filesystem structure
    mkdir /data/misc 01771 system misc
    mkdir /data/misc/bluetoothd 0770 bluetooth bluetooth
    mkdir /data/misc/bluetooth 0770 system system
    mkdir /data/misc/keystore 0700 keystore keystore
    mkdir /data/misc/vpn 0770 system system
    mkdir /data/misc/systemkeys 0700 system system
    mkdir /data/misc/vpn/profiles 0770 system system

    # we restorecon /cache in case the cache partition has been reset.
    restorecon /cache

    # this may have been created by the recovery system with odd permissions
    chown system cache /cache/recovery
    chmod 0770 /cache/recovery
    restorecon /cache/recovery

    # change permissions on kmsg & sysrq-trigger so bugreports can grab kthread stacks
    chown root system /proc/kmsg
    chmod 0440 /proc/kmsg
    chown root system /proc/sysrq-trigger
    chmod 0220 /proc/sysrq-trigger
    chown system log /proc/last_kmsg
    chmod 0440 /proc/last_kmsg

    # create the lost+found directories, so as to enforce our permissions
    mkdir /cache/lost+found 0770 root root
    mkdir /cache/download 0771 system cache

    # create dalvik-cache and double-check the perms
    mkdir /data/dalvik-cache 0771 system system
    chown system system /data/dalvik-cache
    chmod 0771 /data/dalvik-cache

    mkdir /cache/dalvik-cache 0771 system system
    chown system system /cache/dalvik-cache
    chmod 0771 /cache/dalvik-cache

    # create the lost+found directories, so as to enforce our permissions
    mkdir /data/lost+found 0770
    mkdir /cache/lost+found 0770

    # double check the perms, in case lost+found already exists, and set owner
    chown root root /data/lost+found
    chmod 0770 /data/lost+found
    chown root root /cache/lost+found
    chmod 0770 /cache/lost+found

    # LGE_CHANGE_S [taehwan.kim@lge.com] 2010-05-04, 27.8.2 patch., 27.10.1 patch
    # power management
    # mount debugfs
    mkdir /debug
    mount debugfs debugfs /debug

    # switch CPUfreq from performance to ondemand & tune it
    write /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor ondemand
    write /sys/devices/system/cpu/cpufreq/ondemand/up_threshold 70

    # Enabling write by applications such as Web Browser for Performance Boost
    chmod 0664 /sys/devices/system/cpu/cpu1/online
    chmod 0664 /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor

    # Enable Smart Reflex in debugfs
    write /debug/pm_debug/smartreflex/sr_core/autocomp 1
    write /debug/pm_debug/smartreflex/sr_iva/autocomp 1
    write /debug/pm_debug/smartreflex/sr_mpu/autocomp 1

    # Enable off mode by default
    write /debug/pm_debug/enable_off_mode 1
    # LGE_CHANGE_E [kibum.lee@lge.com] 2010-12-09, 27.8.2 patch, 27.10.1 patch

    restorecon /system/etc/firmware/ducati-m3.bin
    # Install kernel modules
    # Install product specific kernel modules
    exec /system/bin/load_modules.sh

    # Set enable_smp if BT LE is supported
    write /sys/module/bluetooth/parameters/enable_smp 1

    # symlink egl.cfg
    symlink /sys/egl/egl.cfg /system/lib/egl/egl.cfg

on post-fs-data
    chown system system /misc
    chmod 0771 /misc

    chown system system /mnt/sdcard # Feature 34534
    chmod 0777 /mnt/sdcard # Feature 34534

    # create mountpoints and mount tmpfs
    mkdir /data/tmp 0777 system system
    symlink /data/tmp /tmp
    mount tmpfs tmpfs /tmp

    chown root system /data/dontpanic
    chmod 0775 /data/dontpanic

# SMC
    mkdir /data/smc 0770 drmrpc drmrpc
    chown drmrpc drmrpc /data/smc/counter.bin
    chown drmrpc drmrpc /data/smc/storage.bin
    chown drmrpc drmrpc /data/smc/system.bin

# Create Directory for widevine
    mkdir /misc/widevine 0770 drm system

    # set SELinux security contexts on upgrade or policy update.
    restorecon_recursive /data

    # create dump dir and collect dumps.
    mkdir /data/dontpanic
    chown root system /data/dontpanic
    chmod 0754 /data/dontpanic

    # collect ramconsole data
    copy /proc/last_kmsg /data/dontpanic/last_kmsg.txt
    chown root log /data/dontpanic/last_kmsg.txt
    chmod 0640 /data/dontpanic/last_kmsg.txt

    # collect apanic data, free resources and re-arm trigger
    copy /proc/apanic_console /data/dontpanic/apanic_console
    chown root log /data/dontpanic/apanic_console
    chmod 0640 /data/dontpanic/apanic_console
    copy /proc/apanic_threads /data/dontpanic/apanic_threads
    chown root log /data/dontpanic/apanic_threads
    chmod 0640 /data/dontpanic/apanic_threads

    mkdir /data/misc/wifi 0775 wifi wifi
    mkdir /data/misc/wifi/sockets 0770 wifi wifi
    mkdir /data/misc/wifi/softap 0771 wifi wifi
    mkdir /data/misc/wifi/wpa_supplicant 0770 wifi wifi
    # mo2hyuntae.do@lge.com SoftAP client UI S
    mkdir /data/misc/dhcp 0770 dhcp dhcp
    chown dhcp dhcp /data/misc/dhcp
    mkdir /data/misc/dhcp 0770 dhcp system
    chown dhcp system /data/misc/dhcp
    # mo2hyuntae.do@lge.com SoftAP client UI E
    chmod 0666 /data/misc/wifi/wpa_supplicant.conf
    chmod 0666 /data/misc/wifi/hostapd.conf
    chmod 0775 /data/misc/wifi
 
    # bluetooth power up/down interface 
    chmod 0660 /sys/class/rfkill/rfkill0/state
    chmod 0660 /sys/class/rfkill/rfkill0/type
    chmod 0660 /sys/class/rfkill/rfkill1/state
    chmod 0660 /sys/class/rfkill/rfkill1/type
    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/state
    chown bluetooth bluetooth /sys/class/rfkill/rfkill0/type
    chown bluetooth bluetooth /sys/class/rfkill/rfkill1/state
    chown bluetooth bluetooth /sys/class/rfkill/rfkill1/type

    chmod 0664 /sys/devices/platform/bd_address/bdaddr_if
    chown radio bluetooth /sys/devices/platform/bd_address/bdaddr_if

    setprop service.brcm.bt.btld 0
    setprop service.brcm.bt.activation 0
    setprop service.brcm.bt.srv_active 0
    setprop service.brcm.bt.hcid_active 0
    setprop sys.settings_secure_version 0

    # Log Service
    mkdir /data/logger 0775 system system
    chown system system /data/logger
    chmod 0771 /data/logger

    chown radio radio /dev/block/mmcblk0p2
    chown radio radio /dev/block/mmcblk0p3
    chmod 0660 /dev/block/mmcblk0p2
    chmod 0660 /dev/block/mmcblk0p3

# LGE_UPDATE_S for CTS Pass
    chown system sdcard_rw /sys/kernel/kobject_lge_nvdata/dynamic_nvdata_raw_read
    chmod 0664 /sys/kernel/kobject_lge_nvdata/dynamic_nvdata_raw_read
    chown system sdcard_rw /sys/kernel/kobject_lge_nvdata/dynamic_nvdata_raw_write
    chmod 0664 /sys/kernel/kobject_lge_nvdata/dynamic_nvdata_raw_write
    chown system sdcard_rw /sys/kernel/kobject_lge_nvdata/static_nvdata_raw_read
    chmod 0664 /sys/kernel/kobject_lge_nvdata/static_nvdata_raw_read
    chown system sdcard_rw /sys/kernel/kobject_lge_nvdata/static_nvdata_raw_write
    chmod 0664 /sys/kernel/kobject_lge_nvdata/static_nvdata_raw_write
# LGE_UPDATE_E for CTS Pass

    chown system system /sys/class/android_usb/android0/f_mass_storage/lun/file
    chmod 0660 /sys/class/android_usb/android0/f_mass_storage/lun/file
    chown system system /sys/class/android_usb/android0/f_rndis/ethaddr
    chmod 0660 /sys/class/android_usb/android0/f_rndis/ethaddr
	
    # By default, the Linux kernel swaps in 8 pages of memory at a time. When using ZRAM, the incremental cost of reading 1 page at a time is negligible and may help in case the device is under extreme memory pressure.
    write /proc/sys/vm/page-cluster 0

    write /proc/sys/vm/highmem_is_dirtyable 1
    write /proc/sys/vm/min_free_kbytes 4096

    # mount system ro
    mount ext4 /dev/block/platform/omap/omap_hsmmc.1/by-name/system /system ro remount

    # Set indication (checked by vold) that we have finished this action
    setprop vold.post_fs_data_done 1

on boot
    mount debugfs /sys/kernel/debug /sys/kernel/debug
    chmod 0666 /dev/pvrsrvkm

    # change permissions for Tiler driver
    chmod 0777 /dev/tiler
    chmod 0777 /dev/dmm

    # change permissions for ION driver
    chmod 0777 /dev/ion

    # usb serial
    chmod 0777 /dev/ttyGS0
    chmod 0777 /dev/ttyGS1
    chmod 0777 /dev/ttyGS2

# misc and nv for CTS Pass
    chown system misc /dev/block/platform/omap/omap_hsmmc.1/by-name/misc
    chmod 0660 /dev/block/platform/omap/omap_hsmmc.1/by-name/misc ## misc partition

    # chown system misc /dev/block/platform/omap/omap_hsmmc.1/by-name/nv
    # chmod 0660 /dev/block/platform/omap/omap_hsmmc.1/by-name/nv ## NV partition

# MUIC
    chown system radio /sys/class/muic/max14526/state
    chown system system /sys/class/muic/max14526/int_state

    chmod 0775 /sys/class/muic/max14526/state
    chmod 0775 /sys/class/muic/max14526/int_state
    
# USB VID
    chown system system /sys/class/android_usb/android0/idVendor    
    chmod 0664 /sys/class/android_usb/android0/idVendor

# LGE GPS
    # gps permissions
    chown system system /sys/devices/platform/gps_gpio/poweron
    chmod 0777 /sys/devices/platform/gps_gpio/poweron
    chown system system /sys/devices/platform/gps_gpio/reset
    chmod 0777 /sys/devices/platform/gps_gpio/reset
    mkdir /data/gps 0775 system net_raw
    mkdir /data/gps/var 0775 system net_raw
    mkdir /data/gps/run 0775 system net_raw
    mkdir /data/gps/log 0770 system net_raw
    mkdir /data/cache
    chmod 777 /data/cache


# initialize the SGX driver
service pvrsrvinit /vendor/bin/pvrsrvinit
	class core
    	user root
	group root
    	oneshot
        disabled


# create filesystems if necessary
service setup_fs /system/bin/setup_fs \
    	/dev/block/platform/omap/omap_hsmmc.1/by-name/cache \
    	/dev/block/platform/omap/omap_hsmmc.1/by-name/userdata
    	class core
    	user root
    	group root
    	oneshot

###################################################
# MSHIELD SMC Daemon - component required to store persistent data coming
#   from the SMC PA to the device persistent storage
###################################################
service tf_daemon /system/bin/tf_daemon \
    	-d -c /vendor/etc/smc_normal_world_android_cfg.ini
    	class main
    	user root
    	group root
    	oneshot
    	disabled

###################################################
# MSHIELD SMC PA Control - installs the SMC PA into the Secure Environment
###################################################
service smc_pa /system/bin/smc_pa_ctrl \
    	-c /vendor/etc/smc_normal_world_android_cfg.ini \
    	start /vendor/firmware/smc_pa.ift
    	class core
    	user root
    	group root
    	oneshot

service glgps /system/bin/glgps -c /system/etc/gps_brcm_conf.xml
        class main
        user system
        group net_raw sdcard_rw system net_admin inet

service lgcpversion /system/bin/lgcpversion
        class late_start
        user root
        oneshot

# Lazy way go get things done when /system(/build.prop) is up
on property:ro.product.device=p920
        wait /sys/class/rfkill/rfkill0/type
        start uim
        wait /data/misc/wifi
        start wlan_precheck

service p2p_supplicant /system/bin/wpa_supplicant \
        -ip2p0 -Dnl80211 -c/data/misc/wifi/p2p_supplicant.conf -N \
        -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf \
        -O/data/misc/wifi/sockets \
        -puse_p2p_group_interface=1 \
        -e/data/misc/wifi/entropy.bin \
	-g@android:wpa_wlan0
        class main
        socket wpa_wlan0 dgram 660 wifi wifi
        disabled
        oneshot

service wpa_supplicant /system/bin/wpa_supplicant \
        -iwlan0 -Dnl80211 -c/data/misc/wifi/wpa_supplicant.conf \
        -O/data/misc/wifi/sockets \
        -e/data/misc/wifi/entropy.bin \
	-g@android:wpa_wlan0
        class main
        socket wpa_wlan0 dgram 660 wifi wifi
        disabled
        oneshot

service uim /system/bin/uim-sysfs
        class core
        user root
        group media bluetooth
        oneshot


service dhcpcd_wlan0 /system/bin/dhcpcd -ABKL
        class main
        disabled
        oneshot

service iprenew_wlan0 /system/bin/dhcpcd -n
        class main
        disabled
        oneshot

service hostapd_bin /system/bin/hostapd -d /data/misc/wifi/hostapd.conf
        class main
     	group system wifi inet
    	socket wpa_wlan1 dgram 660 wifi wifi
    	disabled
    	oneshot

service wlan_precheck /system/bin/wlan-precheck
    	class main
    	disabled
    	oneshot

service dhcpcd_p2p /system/bin/dhcpcd -aABKL
        class main
        disabled
        oneshot

service iprenew_p2p /system/bin/dhcpcd -n
        class main
        disabled
        oneshot

service iprenew_bt-pan /system/bin/dhcpcd -n
        class main
        disabled
        oneshot

service dhcpcd_bt-pan /system/bin/dhcpcd -ABKL
        class main
        disabled
        oneshot

service charger /charger
        class charger
        user root
        group root
        oneshot

# fusewrapped internal sdcard daemon running as media_rw (1023)
service fuse_sdcard0 /system/bin/sdcard -u 1023 -g 1023 -d /mnt/media_rw/sdcard0 /storage/sdcard0
    class late_start

# fusewrapped external sdcard daemon running as media_rw (1023)
service fuse_sdcard1 /system/bin/sdcard -u 1023 -g 1023 -d /mnt/media_rw/sdcard1 /storage/sdcard1
    class late_start
    disabled

on property:init.svc.smc_pa=stopped
    start tf_daemon

service watchdog /sbin/watchdog
    user root
    oneshot

on property:sys.boot_completed=1
    exec /system/bin/wifimac
